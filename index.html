<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Canva Code & AppScript Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            box-sizing: border-box;
        }
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .code-editor {
            font-family: 'Courier New', monospace;
            background: #1e1e1e;
            color: #d4d4d4;
        }
        .syntax-highlight {
            color: #569cd6;
        }
        .animate-pulse-slow {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        .notification {
            animation: slideIn 0.3s ease-out;
        }
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
    </style>
</head>
<body class="min-h-full bg-gray-50">
    <div class="gradient-bg min-h-full">
        <!-- Header -->
        <header class="bg-white/10 backdrop-blur-md border-b border-white/20">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-3">
                        <div class="w-10 h-10 bg-white/20 rounded-lg flex items-center justify-center">
                            <span class="text-2xl">‚ö°</span>
                        </div>
                        <div>
                            <h1 class="text-2xl font-bold text-white">Code Generator Pro</h1>
                            <p class="text-white/80 text-sm">Canva Code & AppScript Generator</p>
                        </div>
                    </div>
                    <div class="flex space-x-2">
                        <button id="clearAll" class="px-4 py-2 bg-red-500/20 text-white rounded-lg hover:bg-red-500/30 transition-colors">
                            üóëÔ∏è Clear All
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <!-- Generator Selection -->
            <div class="bg-white/10 backdrop-blur-md rounded-xl p-6 mb-8 border border-white/20">
                <h2 class="text-xl font-semibold text-white mb-4">Pilih Generator</h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <button id="canvaCodeBtn" class="generator-btn bg-blue-500/20 hover:bg-blue-500/30 text-white p-4 rounded-lg border border-blue-300/30 transition-all ring-2 ring-white/50">
                        <div class="text-2xl mb-2">üé®</div>
                        <div class="font-semibold">Canva Code</div>
                        <div class="text-sm opacity-80">HTML/CSS/JS Generator</div>
                    </button>
                    <button id="appScriptBtn" class="generator-btn bg-green-500/20 hover:bg-green-500/30 text-white p-4 rounded-lg border border-green-300/30 transition-all">
                        <div class="text-2xl mb-2">üìú</div>
                        <div class="font-semibold">Google AppScript</div>
                        <div class="text-sm opacity-80">GAS Code Generator</div>
                    </button>
                    <button id="promptBtn" class="generator-btn bg-purple-500/20 hover:bg-purple-500/30 text-white p-4 rounded-lg border border-purple-300/30 transition-all">
                        <div class="text-2xl mb-2">üí°</div>
                        <div class="font-semibold">Prompt Generator</div>
                        <div class="text-sm opacity-80">AI Prompt Creator</div>
                    </button>
                </div>
            </div>

            <!-- Input Section -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Left Panel - Input -->
                <div class="bg-white/10 backdrop-blur-md rounded-xl p-6 border border-white/20">
                    <h3 class="text-lg font-semibold text-white mb-4">Input Deskripsi</h3>
                    <textarea id="inputDescription" 
                              placeholder="Contoh: Buat aplikasi todo list dengan fitur tambah, edit, hapus, dan filter berdasarkan status..."
                              class="w-full h-40 p-4 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/60 resize-none focus:outline-none focus:ring-2 focus:ring-blue-400"></textarea>
                    
                    <!-- Generator Options -->
                    <div id="generatorOptions" class="mt-6 space-y-4">
                        <!-- Canva Code Options -->
                        <div id="canvaOptions">
                            <h4 class="text-white font-medium mb-3">Opsi Canva Code</h4>
                            <div class="grid grid-cols-2 gap-3">
                                <label class="flex items-center space-x-2 text-white/80">
                                    <input type="checkbox" id="responsive" checked class="rounded">
                                    <span>Responsive Design</span>
                                </label>
                                <label class="flex items-center space-x-2 text-white/80">
                                    <input type="checkbox" id="animations" class="rounded">
                                    <span>Animasi</span>
                                </label>
                                <label class="flex items-center space-x-2 text-white/80">
                                    <input type="checkbox" id="darkMode" class="rounded">
                                    <span>Dark Mode</span>
                                </label>
                                <label class="flex items-center space-x-2 text-white/80">
                                    <input type="checkbox" id="interactive" checked class="rounded">
                                    <span>Interaktif</span>
                                </label>
                            </div>
                        </div>

                        <!-- AppScript Options -->
                        <div id="appScriptOptions" class="hidden">
                            <h4 class="text-white font-medium mb-3">Opsi AppScript</h4>
                            <select id="scriptType" class="w-full p-3 bg-white/10 border border-white/20 rounded-lg text-white">
                                <option value="sheets">Google Sheets Script</option>
                                <option value="docs">Google Docs Script</option>
                                <option value="gmail">Gmail Script</option>
                                <option value="drive">Google Drive Script</option>
                                <option value="calendar">Google Calendar Script</option>
                                <option value="forms">Google Forms Script</option>
                            </select>
                        </div>

                        <!-- Prompt Options -->
                        <div id="promptOptions" class="hidden">
                            <h4 class="text-white font-medium mb-3">Tipe Prompt</h4>
                            <select id="promptType" class="w-full p-3 bg-white/10 border border-white/20 rounded-lg text-white">
                                <option value="canva">Canva Code Prompt</option>
                                <option value="appscript">AppScript Prompt</option>
                                <option value="general">General AI Prompt</option>
                                <option value="creative">Creative Prompt</option>
                            </select>
                        </div>
                    </div>

                    <button id="generateBtn" class="w-full mt-6 bg-gradient-to-r from-blue-500 to-purple-600 text-white py-3 px-6 rounded-lg font-semibold hover:from-blue-600 hover:to-purple-700 transition-all transform hover:scale-105">
                        <span id="generateText">üöÄ Generate Canva Code</span>
                        <span id="loadingText" class="hidden">‚è≥ Generating...</span>
                    </button>
                </div>

                <!-- Right Panel - Output -->
                <div class="bg-white/10 backdrop-blur-md rounded-xl p-6 border border-white/20">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-semibold text-white">Generated Code</h3>
                        <div class="flex space-x-2">
                            <button id="copyBtn" class="px-3 py-1 bg-green-500/20 text-white rounded hover:bg-green-500/30 transition-colors text-sm">
                                üìã Copy
                            </button>
                            <button id="downloadBtn" class="px-3 py-1 bg-blue-500/20 text-white rounded hover:bg-blue-500/30 transition-colors text-sm">
                                üíæ Download
                            </button>
                        </div>
                    </div>
                    <div id="outputContainer" class="h-96 bg-black/30 rounded-lg p-4 overflow-auto">
                        <pre id="codeOutput" class="code-editor text-sm whitespace-pre-wrap">// Generated code akan muncul di sini...
// Pilih generator dan masukkan deskripsi untuk memulai!</pre>
                    </div>
                </div>
            </div>

            <!-- Templates Section -->
            <div class="mt-8 bg-white/10 backdrop-blur-md rounded-xl p-6 border border-white/20">
                <h3 class="text-lg font-semibold text-white mb-4">Template Populer</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    <button class="template-btn text-left p-4 bg-white/5 rounded-lg hover:bg-white/10 transition-colors border border-white/10" data-template="todo">
                        <div class="text-white font-medium">üìù Todo List App</div>
                        <div class="text-white/70 text-sm mt-1">Aplikasi manajemen tugas dengan CRUD</div>
                    </button>
                    <button class="template-btn text-left p-4 bg-white/5 rounded-lg hover:bg-white/10 transition-colors border border-white/10" data-template="dashboard">
                        <div class="text-white font-medium">üìä Dashboard Analytics</div>
                        <div class="text-white/70 text-sm mt-1">Dashboard dengan chart dan statistik</div>
                    </button>
                    <button class="template-btn text-left p-4 bg-white/5 rounded-lg hover:bg-white/10 transition-colors border border-white/10" data-template="ecommerce">
                        <div class="text-white font-medium">üõí E-commerce Cart</div>
                        <div class="text-white/70 text-sm mt-1">Keranjang belanja dengan checkout</div>
                    </button>
                    <button class="template-btn text-left p-4 bg-white/5 rounded-lg hover:bg-white/10 transition-colors border border-white/10" data-template="email">
                        <div class="text-white font-medium">üìß Email Automation</div>
                        <div class="text-white/70 text-sm mt-1">Script otomasi email Gmail</div>
                    </button>
                    <button class="template-btn text-left p-4 bg-white/5 rounded-lg hover:bg-white/10 transition-colors border border-white/10" data-template="sheets">
                        <div class="text-white font-medium">üìà Sheets Data Processor</div>
                        <div class="text-white/70 text-sm mt-1">Pengolah data Google Sheets</div>
                    </button>
                    <button class="template-btn text-left p-4 bg-white/5 rounded-lg hover:bg-white/10 transition-colors border border-white/10" data-template="prompt">
                        <div class="text-white font-medium">üéØ AI Prompt Builder</div>
                        <div class="text-white/70 text-sm mt-1">Generator prompt untuk AI</div>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentGenerator = 'canva';
        
        // Initialize app immediately
        initializeApp();

        function initializeApp() {
            // Generator selection
            const canvaBtn = document.getElementById('canvaCodeBtn');
            const appScriptBtn = document.getElementById('appScriptBtn');
            const promptBtn = document.getElementById('promptBtn');
            
            if (canvaBtn) canvaBtn.addEventListener('click', () => selectGenerator('canva'));
            if (appScriptBtn) appScriptBtn.addEventListener('click', () => selectGenerator('appscript'));
            if (promptBtn) promptBtn.addEventListener('click', () => selectGenerator('prompt'));

            // Generate button
            const generateBtn = document.getElementById('generateBtn');
            if (generateBtn) generateBtn.addEventListener('click', generateCode);

            // Template buttons
            document.querySelectorAll('.template-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const template = this.getAttribute('data-template');
                    loadTemplate(template);
                });
            });

            // Copy button
            const copyBtn = document.getElementById('copyBtn');
            if (copyBtn) copyBtn.addEventListener('click', copyCode);

            // Download button
            const downloadBtn = document.getElementById('downloadBtn');
            if (downloadBtn) downloadBtn.addEventListener('click', downloadCode);

            // Clear all button
            const clearBtn = document.getElementById('clearAll');
            if (clearBtn) clearBtn.addEventListener('click', clearAll);
        }

        function selectGenerator(type) {
            currentGenerator = type;
            
            // Update button states
            document.querySelectorAll('.generator-btn').forEach(btn => {
                btn.classList.remove('ring-2', 'ring-white/50');
            });
            
            if (type === 'canva') {
                document.getElementById('canvaCodeBtn').classList.add('ring-2', 'ring-white/50');
                document.getElementById('generateText').textContent = 'üöÄ Generate Canva Code';
            } else if (type === 'appscript') {
                document.getElementById('appScriptBtn').classList.add('ring-2', 'ring-white/50');
                document.getElementById('generateText').textContent = 'üöÄ Generate AppScript';
            } else {
                document.getElementById('promptBtn').classList.add('ring-2', 'ring-white/50');
                document.getElementById('generateText').textContent = 'üöÄ Generate Prompt';
            }
            
            // Show/hide options
            document.getElementById('canvaOptions').classList.toggle('hidden', type !== 'canva');
            document.getElementById('appScriptOptions').classList.toggle('hidden', type !== 'appscript');
            document.getElementById('promptOptions').classList.toggle('hidden', type !== 'prompt');
        }

        function generateCode() {
            const description = document.getElementById('inputDescription').value.trim();
            if (!description) {
                showNotification('Silakan masukkan deskripsi terlebih dahulu!', 'error');
                return;
            }

            // Show loading state
            document.getElementById('generateText').classList.add('hidden');
            document.getElementById('loadingText').classList.remove('hidden');
            document.getElementById('generateBtn').disabled = true;

            // Simulate generation delay
            setTimeout(() => {
                let generatedCode = '';
                
                try {
                    if (currentGenerator === 'canva') {
                        generatedCode = generateCanvaCode(description);
                    } else if (currentGenerator === 'appscript') {
                        generatedCode = generateAppScript(description);
                    } else {
                        generatedCode = generatePrompt(description);
                    }
                    
                    document.getElementById('codeOutput').textContent = generatedCode;
                    showNotification('Code berhasil di-generate!', 'success');
                } catch (error) {
                    console.error('Generation error:', error);
                    showNotification('Terjadi kesalahan saat generate code', 'error');
                }
                
                // Reset loading state
                document.getElementById('generateText').classList.remove('hidden');
                document.getElementById('loadingText').classList.add('hidden');
                document.getElementById('generateBtn').disabled = false;
            }, 1500);
        }

        function generateCanvaCode(description) {
            const responsive = document.getElementById('responsive').checked;
            const animations = document.getElementById('animations').checked;
            const darkMode = document.getElementById('darkMode').checked;
            const interactive = document.getElementById('interactive').checked;

            return `<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generated App - ${description.split(' ').slice(0, 3).join(' ')}</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { box-sizing: border-box; }
        ${animations ? '.animate-fade-in { animation: fadeIn 0.5s ease-in; }' : ''}
        ${animations ? '@keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }' : ''}
        .card-hover { transition: all 0.3s ease; }
        .card-hover:hover { transform: translateY(-5px); box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
    </style>
</head>
<body class="${darkMode ? 'bg-gray-900 text-white' : 'bg-gradient-to-br from-blue-50 to-indigo-100 text-gray-900'} min-h-full">
    <div class="container mx-auto px-4 py-8">
        <header class="text-center mb-12">
            <h1 class="text-4xl font-bold mb-4 ${animations ? 'animate-fade-in' : ''} ${darkMode ? 'text-white' : 'text-gray-800'}">
                ${description.split(' ').slice(0, 3).join(' ')} App
            </h1>
            <p class="${darkMode ? 'text-gray-300' : 'text-gray-600'} text-lg max-w-2xl mx-auto">
                ${description}
            </p>
        </header>
        
        <main class="max-w-6xl mx-auto">
            <div class="grid ${responsive ? 'grid-cols-1 md:grid-cols-2 lg:grid-cols-3' : 'grid-cols-3'} gap-8 mb-8">
                <div class="card-hover bg-white${darkMode ? ' bg-gray-800 border-gray-700' : ' border-gray-200'} p-6 rounded-xl shadow-lg border">
                    <div class="text-3xl mb-4">üöÄ</div>
                    <h3 class="text-xl font-semibold mb-4 ${darkMode ? 'text-white' : 'text-gray-800'}">Feature Utama</h3>
                    <p class="mb-6 ${darkMode ? 'text-gray-300' : 'text-gray-600'}">Implementasi fitur utama sesuai deskripsi yang Anda berikan.</p>
                    ${interactive ? `<button class="w-full bg-blue-500 text-white px-6 py-3 rounded-lg hover:bg-blue-600 transition-colors font-medium" onclick="handleAction('main')">Jalankan Fitur</button>` : ''}
                </div>
                
                <div class="card-hover bg-white${darkMode ? ' bg-gray-800 border-gray-700' : ' border-gray-200'} p-6 rounded-xl shadow-lg border">
                    <div class="text-3xl mb-4">‚öôÔ∏è</div>
                    <h3 class="text-xl font-semibold mb-4 ${darkMode ? 'text-white' : 'text-gray-800'}">Pengaturan</h3>
                    <p class="mb-6 ${darkMode ? 'text-gray-300' : 'text-gray-600'}">Konfigurasi dan pengaturan aplikasi sesuai kebutuhan.</p>
                    ${interactive ? `<button class="w-full bg-green-500 text-white px-6 py-3 rounded-lg hover:bg-green-600 transition-colors font-medium" onclick="handleAction('settings')">Buka Pengaturan</button>` : ''}
                </div>
                
                <div class="card-hover bg-white${darkMode ? ' bg-gray-800 border-gray-700' : ' border-gray-200'} p-6 rounded-xl shadow-lg border">
                    <div class="text-3xl mb-4">üìä</div>
                    <h3 class="text-xl font-semibold mb-4 ${darkMode ? 'text-white' : 'text-gray-800'}">Analytics</h3>
                    <p class="mb-6 ${darkMode ? 'text-gray-300' : 'text-gray-600'}">Lihat statistik dan analisis penggunaan aplikasi.</p>
                    ${interactive ? `<button class="w-full bg-purple-500 text-white px-6 py-3 rounded-lg hover:bg-purple-600 transition-colors font-medium" onclick="handleAction('analytics')">Lihat Data</button>` : ''}
                </div>
            </div>

            <!-- Interactive Demo Section -->
            ${interactive ? `
            <div class="bg-white${darkMode ? ' bg-gray-800 border-gray-700' : ' border-gray-200'} p-8 rounded-xl shadow-lg border">
                <h2 class="text-2xl font-bold mb-6 ${darkMode ? 'text-white' : 'text-gray-800'}">Demo Interaktif</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-sm font-medium mb-2 ${darkMode ? 'text-gray-300' : 'text-gray-700'}">Input Data</label>
                        <input type="text" id="demoInput" placeholder="Masukkan data..." class="w-full p-3 border rounded-lg ${darkMode ? 'bg-gray-700 border-gray-600 text-white' : 'bg-white border-gray-300'} focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2 ${darkMode ? 'text-gray-300' : 'text-gray-700'}">Hasil</label>
                        <div id="demoOutput" class="w-full p-3 border rounded-lg ${darkMode ? 'bg-gray-700 border-gray-600 text-gray-300' : 'bg-gray-50 border-gray-300 text-gray-600'} min-h-[48px] flex items-center">
                            Hasil akan muncul di sini...
                        </div>
                    </div>
                </div>
                <button onclick="processDemo()" class="mt-4 bg-indigo-500 text-white px-6 py-3 rounded-lg hover:bg-indigo-600 transition-colors font-medium">
                    Proses Data
                </button>
            </div>
            ` : ''}
        </main>
    </div>

    ${interactive ? `<script>
        function handleAction(action) {
            const messages = {
                'main': 'Fitur utama berhasil dijalankan!',
                'settings': 'Membuka panel pengaturan...',
                'analytics': 'Memuat data analytics...'
            };
            
            showMessage(messages[action] || 'Aksi berhasil dijalankan!');
        }

        function processDemo() {
            const input = document.getElementById('demoInput').value;
            const output = document.getElementById('demoOutput');
            
            if (input.trim()) {
                output.textContent = 'Memproses: "' + input + '" - Hasil berhasil diproses!';
                output.className = output.className.replace('text-gray-600', 'text-green-600').replace('text-gray-300', 'text-green-400');
            } else {
                output.textContent = 'Silakan masukkan data terlebih dahulu';
                output.className = output.className.replace('text-green-600', 'text-red-600').replace('text-green-400', 'text-red-400');
            }
        }

        function showMessage(message) {
            const notification = document.createElement('div');
            notification.className = 'fixed top-4 right-4 bg-blue-500 text-white p-4 rounded-lg shadow-lg z-50 transform transition-all duration-300';
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        // Auto-focus demo input
        document.addEventListener('DOMContentLoaded', function() {
            const demoInput = document.getElementById('demoInput');
            if (demoInput) {
                demoInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        processDemo();
                    }
                });
            }
        });
    </script>` : ''}
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'98eaf536e7819af4',t:'MTc2MDQ4NTYwNi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>`;
        }

        function generateAppScript(description) {
            const scriptType = document.getElementById('scriptType').value;
            
            const templates = {
                'sheets': `/**
 * Google Sheets Script - ${description}
 * Generated automatically
 */

function onOpen() {
  const ui = SpreadsheetApp.getUi();
  ui.createMenu('üöÄ Custom Menu')
    .addItem('Jalankan Fungsi Utama', 'mainFunction')
    .addItem('Proses Data', 'processData')
    .addItem('Export Data', 'exportData')
    .addToUi();
}

function mainFunction() {
  try {
    const sheet = SpreadsheetApp.getActiveSheet();
    const data = sheet.getDataRange().getValues();
    
    Logger.log('Memproses ' + data.length + ' baris data');
    Logger.log('Deskripsi: ${description}');
    
    // Implementasi logika utama
    for (let i = 1; i < data.length; i++) {
      // Proses setiap baris data
      Logger.log('Memproses baris: ' + (i + 1));
      
      // Contoh: Validasi data
      if (data[i][0] && data[i][0].toString().trim() !== '') {
        // Data valid, lakukan pemrosesan
        processRow(data[i], i + 1);
      }
    }
    
    SpreadsheetApp.getUi().alert('‚úÖ Proses berhasil diselesaikan!');
    
  } catch (error) {
    Logger.log('Error: ' + error.toString());
    SpreadsheetApp.getUi().alert('‚ùå Terjadi kesalahan: ' + error.toString());
  }
}

function processRow(rowData, rowNumber) {
  // Implementasi pemrosesan per baris
  // Sesuaikan dengan kebutuhan: ${description}
  
  Logger.log('Memproses baris ' + rowNumber + ': ' + rowData.join(', '));
  
  // Contoh: Update status di kolom terakhir
  const sheet = SpreadsheetApp.getActiveSheet();
  const lastColumn = sheet.getLastColumn();
  sheet.getRange(rowNumber, lastColumn + 1).setValue('Processed: ' + new Date().toLocaleString());
}

function processData() {
  const sheet = SpreadsheetApp.getActiveSheet();
  const range = sheet.getDataRange();
  const values = range.getValues();
  
  // Implementasi khusus berdasarkan: ${description}
  
  let processedCount = 0;
  
  for (let i = 1; i < values.length; i++) {
    // Custom processing logic
    if (validateRowData(values[i])) {
      processedCount++;
    }
  }
  
  Logger.log('Data berhasil diproses: ' + processedCount + ' item');
  SpreadsheetApp.getUi().alert('Pemrosesan selesai: ' + processedCount + ' item berhasil diproses');
}

function validateRowData(row) {
  // Validasi data sesuai kebutuhan
  return row[0] && row[0].toString().trim() !== '';
}

function exportData() {
  const sheet = SpreadsheetApp.getActiveSheet();
  const data = sheet.getDataRange().getValues();
  
  // Export logic berdasarkan: ${description}
  Logger.log('Mengexport ' + data.length + ' baris data');
  
  // Contoh: Buat sheet baru untuk hasil export
  const newSheet = SpreadsheetApp.getActiveSpreadsheet().insertSheet('Export_' + Utilities.formatDate(new Date(), Session.getScriptTimeZone(), 'yyyyMMdd_HHmmss'));
  newSheet.getRange(1, 1, data.length, data[0].length).setValues(data);
  
  SpreadsheetApp.getUi().alert('‚úÖ Data berhasil diexport ke sheet: ' + newSheet.getName());
}`,

                'gmail': `/**
 * Gmail Script - ${description}
 * Generated automatically
 */

function processEmails() {
  try {
    const threads = GmailApp.search('is:unread', 0, 50);
    let processedCount = 0;
    
    Logger.log('Memproses ' + threads.length + ' thread email');
    Logger.log('Deskripsi: ${description}');
    
    threads.forEach(thread => {
      const messages = thread.getMessages();
      
      messages.forEach(message => {
        if (message.isUnread()) {
          processEmail(message);
          processedCount++;
        }
      });
    });
    
    Logger.log('Email berhasil diproses: ' + processedCount + ' pesan');
    
  } catch (error) {
    Logger.log('Error: ' + error.toString());
  }
}

function processEmail(message) {
  // Implementasi pemrosesan email berdasarkan: ${description}
  
  const subject = message.getSubject();
  const sender = message.getFrom();
  const body = message.getPlainBody();
  
  Logger.log('Memproses email dari: ' + sender + ', Subject: ' + subject);
  
  // Contoh: Auto-reply berdasarkan kondisi tertentu
  if (shouldAutoReply(subject, sender)) {
    sendAutoReply(message);
  }
  
  // Contoh: Kategorisasi email
  categorizeEmail(message);
  
  // Mark as read
  message.markRead();
}

function shouldAutoReply(subject, sender) {
  // Logic untuk menentukan apakah perlu auto-reply
  // Sesuaikan dengan: ${description}
  
  const autoReplyKeywords = ['urgent', 'penting', 'segera'];
  return autoReplyKeywords.some(keyword => 
    subject.toLowerCase().includes(keyword)
  );
}

function sendAutoReply(originalMessage) {
  const replySubject = 'Re: ' + originalMessage.getSubject();
  const replyBody = \`
Terima kasih atas email Anda.

Pesan ini adalah balasan otomatis berdasarkan: ${description}

Email Anda telah diterima dan akan diproses segera.

Salam,
Sistem Otomatis
  \`;
  
  GmailApp.sendEmail(
    originalMessage.getFrom(),
    replySubject,
    replyBody
  );
  
  Logger.log('Auto-reply dikirim ke: ' + originalMessage.getFrom());
}

function categorizeEmail(message) {
  // Kategorisasi email berdasarkan content
  const subject = message.getSubject().toLowerCase();
  const body = message.getPlainBody().toLowerCase();
  
  let label = '';
  
  if (subject.includes('invoice') || subject.includes('tagihan')) {
    label = 'Finance';
  } else if (subject.includes('meeting') || subject.includes('rapat')) {
    label = 'Meetings';
  } else if (subject.includes('urgent') || subject.includes('penting')) {
    label = 'Urgent';
  } else {
    label = 'General';
  }
  
  // Buat atau dapatkan label
  try {
    const gmailLabel = GmailApp.getUserLabelByName(label) || GmailApp.createLabel(label);
    const thread = message.getThread();
    thread.addLabel(gmailLabel);
    
    Logger.log('Email dikategorikan ke: ' + label);
  } catch (error) {
    Logger.log('Error saat kategorisasi: ' + error.toString());
  }
}

function createEmailFilter() {
  // Buat filter email otomatis
  // Implementasi berdasarkan: ${description}
  
  Logger.log('Filter email berhasil dibuat');
}

function scheduleEmailSending() {
  // Jadwalkan pengiriman email
  // Gunakan trigger untuk automasi
  
  ScriptApp.newTrigger('processEmails')
    .timeBased()
    .everyHours(1)
    .create();
    
  Logger.log('Trigger email otomatis berhasil dibuat');
}`,

                'drive': `/**
 * Google Drive Script - ${description}
 * Generated automatically
 */

function organizeDriveFiles() {
  try {
    Logger.log('Memulai organisasi file Drive');
    Logger.log('Deskripsi: ${description}');
    
    const files = DriveApp.getFiles();
    let processedCount = 0;
    
    while (files.hasNext()) {
      const file = files.next();
      
      if (shouldProcessFile(file)) {
        processFile(file);
        processedCount++;
      }
      
      // Batasi untuk menghindari timeout
      if (processedCount >= 100) break;
    }
    
    Logger.log('File berhasil diproses: ' + processedCount);
    
  } catch (error) {
    Logger.log('Error: ' + error.toString());
  }
}

function shouldProcessFile(file) {
  // Tentukan file mana yang perlu diproses
  // Berdasarkan: ${description}
  
  const fileName = file.getName();
  const fileSize = file.getSize();
  const lastModified = file.getLastUpdated();
  
  // Contoh: Proses file yang dimodifikasi dalam 30 hari terakhir
  const thirtyDaysAgo = new Date();
  thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);
  
  return lastModified > thirtyDaysAgo && fileSize > 0;
}

function processFile(file) {
  // Implementasi pemrosesan file
  const fileName = file.getName();
  const fileType = file.getMimeType();
  
  Logger.log('Memproses file: ' + fileName + ' (' + fileType + ')');
  
  // Contoh: Organisasi berdasarkan tipe file
  organizeByFileType(file);
  
  // Contoh: Backup file penting
  if (isImportantFile(file)) {
    backupFile(file);
  }
}

function organizeByFileType(file) {
  const fileType = file.getMimeType();
  let folderName = '';
  
  if (fileType.includes('image')) {
    folderName = 'Images';
  } else if (fileType.includes('document')) {
    folderName = 'Documents';
  } else if (fileType.includes('spreadsheet')) {
    folderName = 'Spreadsheets';
  } else if (fileType.includes('presentation')) {
    folderName = 'Presentations';
  } else {
    folderName = 'Others';
  }
  
  // Buat folder jika belum ada
  const folders = DriveApp.getFoldersByName(folderName);
  let targetFolder;
  
  if (folders.hasNext()) {
    targetFolder = folders.next();
  } else {
    targetFolder = DriveApp.createFolder(folderName);
  }
  
  // Pindahkan file ke folder yang sesuai
  try {
    file.getParents().next().removeFile(file);
    targetFolder.addFile(file);
    Logger.log('File dipindahkan ke folder: ' + folderName);
  } catch (error) {
    Logger.log('Error memindahkan file: ' + error.toString());
  }
}

function isImportantFile(file) {
  const fileName = file.getName().toLowerCase();
  const importantKeywords = ['important', 'penting', 'backup', 'final'];
  
  return importantKeywords.some(keyword => fileName.includes(keyword));
}

function backupFile(file) {
  // Buat backup file penting
  const backupFolders = DriveApp.getFoldersByName('Backup');
  let backupFolder;
  
  if (backupFolders.hasNext()) {
    backupFolder = backupFolders.next();
  } else {
    backupFolder = DriveApp.createFolder('Backup');
  }
  
  const copy = file.makeCopy('BACKUP_' + file.getName(), backupFolder);
  Logger.log('Backup dibuat: ' + copy.getName());
}

function cleanupOldFiles() {
  // Bersihkan file lama
  const cutoffDate = new Date();
  cutoffDate.setDate(cutoffDate.getDate() - 365); // 1 tahun yang lalu
  
  const files = DriveApp.getFiles();
  let deletedCount = 0;
  
  while (files.hasNext()) {
    const file = files.next();
    
    if (file.getLastUpdated() < cutoffDate && !isImportantFile(file)) {
      try {
        DriveApp.removeFile(file);
        deletedCount++;
        Logger.log('File dihapus: ' + file.getName());
      } catch (error) {
        Logger.log('Error menghapus file: ' + error.toString());
      }
    }
  }
  
  Logger.log('File lama berhasil dihapus: ' + deletedCount);
}`
            };
            
            return templates[scriptType] || templates['sheets'];
        }

        function generatePrompt(description) {
            const promptType = document.getElementById('promptType').value;
            
            const templates = {
                'canva': `# üé® Canva Code Generation Prompt

## üéØ Objective
Create a fully functional, interactive web application with the following specifications:

**User Request:** ${description}

## üìã Technical Requirements

### Core Technologies
- HTML5 with semantic elements
- CSS3 with modern features (Grid, Flexbox, Animations)
- Vanilla JavaScript (ES6+)
- Tailwind CSS for styling
- Responsive design (mobile-first approach)

### Design Standards
- Modern, clean, and professional UI
- Consistent color scheme and typography
- Proper spacing and visual hierarchy
- Smooth animations and micro-interactions
- Accessibility compliance (ARIA labels, keyboard navigation)

### Functionality Requirements
- All buttons and interactive elements must work
- Form validation with user feedback
- Error handling and loading states
- Data persistence using localStorage
- Cross-browser compatibility

### Code Quality
- Clean, well-commented code
- Modular JavaScript functions
- Semantic HTML structure
- Efficient CSS with no unused styles
- Performance optimized

## üöÄ Implementation Guidelines

1. **Structure**: Single HTML file with inline CSS and JavaScript
2. **Styling**: Use Tailwind CSS classes with custom CSS for animations
3. **Interactivity**: Implement all user interactions with proper feedback
4. **Responsiveness**: Ensure perfect display on all device sizes
5. **Performance**: Optimize for fast loading and smooth interactions

## ‚úÖ Success Criteria
- Application works perfectly without external dependencies
- All features from the description are implemented
- Code is production-ready and well-documented
- User experience is intuitive and engaging

Please generate a complete, working web application that exceeds these requirements.`,

                'appscript': `# üìú Google Apps Script Generation Prompt

## üéØ Objective
Develop a comprehensive Google Apps Script solution for:

**Requirement:** ${description}

## üîß Technical Specifications

### Core Requirements
- Google Apps Script (JavaScript ES5 compatible)
- Proper error handling with try-catch blocks
- Comprehensive logging for debugging
- User-friendly interface elements
- Efficient API usage and batch operations

### Integration Points
- Google Workspace APIs (Sheets, Gmail, Drive, Calendar, Docs, Forms)
- External APIs (if applicable)
- Trigger-based automation
- Custom menu integration
- Dialog and sidebar interfaces

### Security & Performance
- Proper authorization scopes
- Input validation and sanitization
- Rate limit handling
- Efficient data processing
- Memory usage optimization

## üìö Code Structure

### Main Components
1. **Main execution function** with comprehensive error handling
2. **Helper functions** for specific tasks and operations
3. **UI components** (menus, dialogs, sidebars)
4. **Configuration settings** and constants
5. **Utility functions** for common operations

### Documentation Requirements
- Function descriptions with JSDoc format
- Parameter explanations and types
- Usage examples and setup instructions
- Error handling documentation
- Performance considerations

## üéØ Implementation Guidelines

1. **Modularity**: Break down complex operations into smaller functions
2. **Error Handling**: Implement robust error catching and user feedback
3. **Logging**: Add comprehensive logging for monitoring and debugging
4. **User Experience**: Create intuitive interfaces and clear feedback
5. **Performance**: Optimize for Google Apps Script execution limits

## ‚úÖ Deliverables
- Complete, working Google Apps Script code
- Setup and installation instructions
- Usage documentation with examples
- Error handling and troubleshooting guide

Please create a production-ready solution that fully addresses the requirement.`,

                'creative': `# üé® Creative Content Generation Prompt

## üåü Creative Brief
Generate compelling, original content based on:

**Theme/Topic:** ${description}

## üé≠ Creative Direction

### Tone & Voice
- Authentic and engaging
- Appropriate for target audience
- Memorable and impactful
- Professional yet approachable
- Emotionally resonant

### Content Structure
- Compelling opening hook
- Logical flow and progression
- Varied sentence structures
- Specific examples and details
- Strong, actionable conclusion

### Creative Elements
- Vivid, descriptive language
- Sensory details and imagery
- Unique perspectives and insights
- Storytelling techniques
- Emotional connections

## üéØ Content Requirements

### Engagement Factors
- Immediate attention capture
- Value-driven content
- Relatable examples
- Clear benefits and outcomes
- Compelling call-to-action

### Quality Standards
- Original and plagiarism-free
- Factually accurate information
- Proper grammar and style
- Consistent voice throughout
- Professional presentation

### Format Considerations
- Scannable structure with headers
- Bullet points for key information
- Strategic use of white space
- Visual hierarchy and flow
- Mobile-friendly formatting

## üöÄ Success Metrics
- Captures and maintains attention
- Delivers clear value proposition
- Inspires desired action
- Memorable and shareable
- Achieves communication objectives

Please create content that exceeds expectations and delivers exceptional value.`,

                'general': `# ü§ñ Comprehensive AI Assistant Prompt

## üìã Task Overview
Provide a thorough, helpful response for:

**Request:** ${description}

## üéØ Response Requirements

### Content Quality
- Accurate and up-to-date information
- Comprehensive coverage of all aspects
- Clear, understandable language
- Logical organization and structure
- Actionable insights and advice

### Research Standards
- Fact-check all claims and statements
- Consider multiple perspectives
- Provide balanced viewpoints
- Include relevant context and background
- Cite sources when appropriate

### Format Guidelines
- Use clear headings and subheadings
- Include bullet points for lists
- Provide practical examples
- Add step-by-step instructions when applicable
- Conclude with key takeaways

## üîç Analysis Framework

### Information Gathering
1. Identify core requirements and objectives
2. Research relevant background information
3. Consider various approaches and solutions
4. Evaluate pros and cons of different options
5. Determine best practices and recommendations

### Response Structure
1. **Introduction**: Context and overview
2. **Main Content**: Detailed information and analysis
3. **Examples**: Practical applications and use cases
4. **Recommendations**: Best practices and next steps
5. **Conclusion**: Summary and key takeaways

## ‚úÖ Quality Assurance
- Verify accuracy of all information
- Ensure completeness of coverage
- Check for clarity and readability
- Validate practical applicability
- Include appropriate disclaimers

Please provide a comprehensive, valuable response that fully addresses the request with expertise and insight.`
            };
            
            return templates[promptType] || templates['general'];
        }

        function loadTemplate(template) {
            const templates = {
                'todo': 'Buat aplikasi todo list dengan fitur tambah tugas baru, edit tugas yang ada, hapus tugas, tandai sebagai selesai, dan filter berdasarkan status (semua, aktif, selesai). Gunakan desain modern dengan animasi smooth dan local storage untuk menyimpan data.',
                'dashboard': 'Buat dashboard analytics dengan chart interaktif, statistik real-time, tabel data yang bisa diurutkan, filter tanggal, dan export data ke CSV. Gunakan warna yang profesional dan layout yang responsive dengan sidebar navigasi.',
                'ecommerce': 'Buat keranjang belanja dengan daftar produk, tambah ke keranjang, ubah quantity, hapus item, hitung total harga dengan pajak, dan form checkout lengkap. Sertakan validasi form dan konfirmasi pembelian dengan animasi.',
                'email': 'Buat script Google Apps Script untuk otomasi email Gmail: kirim email otomatis berdasarkan kondisi tertentu, buat template email dinamis, jadwalkan pengiriman email berkala, dan kategorisasi email masuk otomatis.',
                'sheets': 'Buat script Google Apps Script untuk mengolah data di Google Sheets: import data dari sumber eksternal, validasi dan pembersihan data, buat laporan otomatis dengan chart, dan export ke berbagai format.',
                'prompt': 'Buat generator prompt AI yang dapat membuat prompt berkualitas tinggi untuk berbagai keperluan: coding, creative writing, business analysis, problem solving, dan content creation dengan template yang dapat disesuaikan.'
            };
            
            document.getElementById('inputDescription').value = templates[template] || '';
        }

        function copyCode() {
            const code = document.getElementById('codeOutput').textContent;
            if (code && code.trim() !== '' && !code.includes('Generated code akan muncul')) {
                // Simple fallback copy method
                const textArea = document.createElement('textarea');
                textArea.value = code;
                textArea.style.position = 'fixed';
                textArea.style.left = '-999999px';
                textArea.style.top = '-999999px';
                document.body.appendChild(textArea);
                textArea.focus();
                textArea.select();
                
                try {
                    document.execCommand('copy');
                    const btn = document.getElementById('copyBtn');
                    btn.textContent = '‚úÖ Copied!';
                    setTimeout(() => {
                        btn.textContent = 'üìã Copy';
                    }, 2000);
                    alert('Code berhasil disalin!');
                } catch (err) {
                    alert('Gagal menyalin code');
                }
                
                document.body.removeChild(textArea);
            } else {
                alert('Belum ada code untuk disalin');
            }
        }

        function downloadCode() {
            const code = document.getElementById('codeOutput').textContent;
            if (code && code.trim() !== '' && !code.includes('Generated code akan muncul')) {
                let filename = 'generated-code.txt';
                let mimeType = 'text/plain';
                
                if (currentGenerator === 'canva') {
                    filename = 'canva-code.html';
                    mimeType = 'text/html';
                } else if (currentGenerator === 'appscript') {
                    filename = 'appscript-code.js';
                    mimeType = 'text/javascript';
                } else {
                    filename = 'ai-prompt.txt';
                }
                
                const blob = new Blob([code], { type: mimeType });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                showNotification('File berhasil didownload!', 'success');
            } else {
                showNotification('Belum ada code untuk didownload', 'error');
            }
        }

        function clearAll() {
            if (confirm('Apakah Anda yakin ingin menghapus semua input dan output?')) {
                document.getElementById('inputDescription').value = '';
                document.getElementById('codeOutput').textContent = '// Generated code akan muncul di sini...\n// Pilih generator dan masukkan deskripsi untuk memulai!';
                alert('Semua data berhasil dihapus');
            }
        }

        function showNotification(message, type) {
            // Simple alert fallback for better compatibility
            alert(message);
        }
    </script>
</body>
</html>
